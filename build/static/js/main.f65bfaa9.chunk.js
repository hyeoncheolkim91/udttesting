(this["webpackJsonpuniversal-data-tool"]=this["webpackJsonpuniversal-data-tool"]||[]).push([[0],{341:function(e,t){},411:function(e,t,n){e.exports=n(721)},416:function(e,t,n){},440:function(e){e.exports=JSON.parse("{}")},704:function(e,t){},720:function(e,t,n){},721:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(20),i=n.n(o),c=n(350),l=n.n(c),s=n(769),u=(n(416),n(114)),m=l()({palette:{primary:u.a,secondary:u.a},typography:{fontFamily:'"Inter", "Roboto", sans-serif',button:{textTransform:"none"}}}),d=function(e){var t=e.children;return r.a.createElement(s.a,{theme:m},t)},f=n(13),p=n(14),b=n.n(p),h=n(27),g=n(8),v=n(778),O=n(77),E=n(772),j=n(773),w=n(795),y=n(774),S=n(771),C=n(155),x=n.n(C),k=n(354),I=n.n(k),T=n(122),N=n.n(T),D=n(355),L=n.n(D),P=n(725),_=(n(440),n(243)),R=n.n(_),A=n(387),B=n(116),M=n(121),z=n(268),U=B.a[500],J={bottom:"100%",left:"25%",border:"solid transparent",content:'" "',height:0,width:0,position:"absolute",pointerEvents:"none"},F=Object(A.a)("div")({position:"absolute",zIndex:10,top:45,padding:16,boxSizing:"border-box",borderRadius:4,left:-53,backgroundColor:"#fff",border:"1px solid ".concat(U),width:300,minHeight:200,boxShadow:"0px 3px 12px rgba(0,0,0,0.3)","&:before":Object(f.a)(Object(f.a)({},J),{},{borderColor:"rgba(0,0,0, 0)",borderBottomColor:U,borderWidth:12,marginLeft:-12}),"&:after":Object(f.a)(Object(f.a)({},J),{},{borderColor:"rgba(255,255,255, 0)",borderBottomColor:"#fff",borderWidth:10,marginLeft:-10}),"& h1":{fontSize:18,marginTop:0,color:u.a[800]},"& h2":{fontSize:14,color:B.a[800]},opacity:1,transition:"opacity 200ms linear, transform 200ms ease","&.hidden":{opacity:0,transform:"translate(0, 10px)",pointerEvents:"none"}}),W=function(e){var t=e.open,n=e.children;return r.a.createElement(F,{className:t?"":"hidden"},n)},H=n(796),V=Object(A.a)("div")({position:"relative"}),G=Object(A.a)(z.a)({justifyContent:"flex-start","& .fakeicon":{display:"inline",marginRight:8,padding:4,paddingTop:5,fontSize:11,fontWeight:"bold",color:"#fff",backgroundColor:B.a[700],borderRadius:4,width:36,"&.blue":{backgroundColor:u.a[700]},"&.green":{backgroundColor:M.a[700]}}}),q=function(e){var t=e.onDownload,n=Object(a.useState)(!1),o=Object(g.a)(n,2),i=o[0],c=o[1],l=Object(H.a)().t;return r.a.createElement(V,{onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)}},r.a.createElement(P.a,null,r.a.createElement(R.a,null)),r.a.createElement(W,{open:i},r.a.createElement("h1",null,l("download")),r.a.createElement(G,{fullWidth:!0,onClick:function(){return t("csv")}},r.a.createElement("div",{className:"fakeicon green"},"CSV"),l("download")," CSV"),r.a.createElement(G,{fullWidth:!0,onClick:function(){return t("json")}},r.a.createElement("div",{className:"fakeicon blue"},"JSON"),l("download")," JSON")))},K=Object(S.a)((function(e){return{headerButton:{marginLeft:16},grow:{flexGrow:1},list:{width:300},tab:{color:"#000","& .icon":{}},fullHeightTab:Object(f.a)(Object(f.a)({},e.mixins.toolbar),{},Object(O.a)({},e.breakpoints.down("sm"),{minWidth:20})),tabWrapper:{display:"flex",flexDirection:"row",alignItems:"center",textTransform:"none",color:"#000","&&& svg":{marginBottom:0,marginRight:8,width:18,height:18}}}})),Y=function(e){switch(e){case"Setup":return r.a.createElement(x.a,{className:"icon"});case"Label":return r.a.createElement(N.a,{className:"icon"});case"Samples":return r.a.createElement(I.a,{className:"icon"});default:return r.a.createElement("div",null)}},Z=Object(a.memo)((function(e){var t=e.tabs,n=e.currentTab,a=e.onChangeTab,o=e.additionalButtons,i=e.onOpenDrawer,c=(e.title,e.isDesktop),l=e.fileOpen,s=e.isSmall,u=e.onDownload,m=K();return r.a.createElement(E.a,{color:"default",position:"static"},r.a.createElement(j.a,{variant:"dense"},!c&&r.a.createElement(P.a,{onClick:i,className:m.headerButton},r.a.createElement(L.a,null)),!c&&l&&r.a.createElement(q,{onDownload:u}),r.a.createElement("div",{className:m.grow}),o,t.length>0&&r.a.createElement(w.a,{onChange:function(e,t){return a(t.toLowerCase())},value:n},t.map((function(e){return r.a.createElement(y.a,{key:e,classes:{root:m.fullHeightTab,wrapper:m.tabWrapper},className:m.tab,icon:Y(e),label:s?"":e,value:e.toLowerCase()})})))))})),$=n(798),Q=n(775),X=n(727),ee=n(270),te=n(776),ne=n(777),ae=n(386),re=n(357),oe=n.n(re),ie=n(356),ce=[{name:"Image Classification",Icon:n.n(ie).a,dataset:{interface:{type:"image_classification",labels:["valid","invalid"]},samples:[{imageUrl:"https://s3.amazonaws.com/asset.workaround.online/example-jobs/sticky-notes/image1.jpg"},{imageUrl:"https://s3.amazonaws.com/asset.workaround.online/example-jobs/sticky-notes/image2.jpg"}]}}],le=ce.reduce((function(e,t){return e[t.name]=t,e[t.dataset.interface.type]=t,e}),{}),se=ce,ue=Object(S.a)({}),me=function(e){var t=e.onClickHome,n=e.onCloseDrawer,a=e.drawerOpen,o=(e.onOpenFile,e.onClickTemplate),i=ue();return r.a.createElement($.a,{open:a,onClose:n},r.a.createElement(Q.a,{className:i.list},r.a.createElement(X.a,{onClick:t,button:!0},r.a.createElement(te.a,null,r.a.createElement(oe.a,null)),r.a.createElement(ee.a,null,"Home")),r.a.createElement(ne.a,null,"Create From Template"),se.map((function(e){return r.a.createElement(X.a,{button:!0,key:e.name,onClick:function(){return o(e)}},r.a.createElement(te.a,null,r.a.createElement(e.Icon,null)),r.a.createElement(ee.a,null,e.name))})),r.a.createElement(X.a,{button:!0,onClick:function(){window.location.href="/"}},r.a.createElement(te.a,null,r.a.createElement(ae.a,null)),r.a.createElement(ee.a,null,"Github"))))},de=Object(a.createContext)({recentItems:[],changeRecentItems:function(){return null},onClickTemplate:function(){return null},onClickHome:function(){return null},onOpenFile:function(){return null},onOpenRecentItem:function(){return null},isDesktop:!1,inSession:!1,onJoinSession:function(){return null},onCreateSession:function(){return null},onLeaveSession:function(){return null},sessionBoxOpen:!1,changeSessionBoxOpen:function(){return null},fileOpen:!1,onDownload:function(){return null},authConfig:null,onUserChange:function(){return null},user:null,logoutUser:function(){return null}}),fe=[],pe=function(e){var t=e.additionalButtons,n=void 0===t?fe:t,o=e.title,i=e.currentTab,c=e.onChangeTab,l=e.tabs,s=void 0===l?fe:l,u=Object(a.useState)(!1),m=Object(g.a)(u,2),d=m[0],f=m[1],p=Object(a.useContext)(de);p.recentItems||(p.recentItems=[]);var b=Object(v.a)("(max-width: 800px)"),h=Object(a.useCallback)((function(){return f(!0)}),[]),O=Object(a.useCallback)((function(){return f(!1)}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Z,Object.assign({tabs:s,currentTab:i,onChangeTab:c,additionalButtons:n,onOpenDrawer:h,isSmall:b},p,{title:o})),r.a.createElement(me,{drawerOpen:d,onCloseDrawer:O,onClickHome:p.onClickHome,recentItems:p.recentItems,changeRecentItems:p.changeRecentItems,onOpenFile:p.onOpenFile,onClickTemplate:p.onClickTemplate,onOpenRecentItem:p.onOpenRecentItem}))},be=n(784),he=n(783),ge=n(782),ve=n(781),Oe=n(780),Ee=n(779),je=n(360),we=n.n(je),ye=n(192),Se=n.n(ye),Ce=n(359),xe=n.n(Ce),ke=n(119),Ie=n(358),Te=n.n(Ie),Ne=Object(A.a)(Ee.a)({backgroundColor:B.a[100],borderBottom:"1px solid ".concat(B.a[300]),paddingBottom:12,boxShadow:"0px 2px 3px rgba(0,0,0,0.05)"}),De=Object(A.a)(Oe.a)({paddingTop:16}),Le=Object(A.a)(ve.a)({backgroundColor:B.a[100],borderTop:"1px solid ".concat(B.a[300])}),Pe=function(e){var t=e.open,n=void 0!==t&&t,o=e.title,i=e.children,c=e.markdownContent,l=e.onClose,s=e.red,m=e.noActionBar,d=void 0!==m&&m,f=e.actions,p=void 0===f?[]:f,b=Object(a.useState)(!1),h=Object(g.a)(b,2),v=h[0],O=h[1];return r.a.createElement(ge.a,{open:n,onClose:l,fullScreen:v},r.a.createElement(Ne,null,r.a.createElement(he.a,{display:"flex",alignItems:"center"},r.a.createElement("span",{style:{color:s?ke.a[700]:void 0}},o),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(P.a,{onClick:function(){return O(!v)}},v?r.a.createElement(xe.a,null):r.a.createElement(Se.a,null)),r.a.createElement(P.a,{onClick:l},r.a.createElement(we.a,null)))),r.a.createElement(De,null,r.a.createElement(he.a,{maxWidth:"90vw",minWidth:400,lineHeight:1.5},c?r.a.createElement(Te.a,{source:c}):i)),!d&&r.a.createElement(Le,null,r.a.createElement(z.a,{onClick:function(){return l()}},r.a.createElement("span",{style:{color:B.a[700],fontWeight:500}},"Close")),p.map((function(e,t){return r.a.createElement(z.a,{disabled:e.disabled,key:t,onClick:e.onClick},r.a.createElement("span",{style:{color:s?ke.a[700]:u.a[700],fontWeight:500}},e.text))}))))},_e=Object(S.a)({bigButton:{padding:10,width:150,height:120,border:"1px solid #ccc",margin:10},bigIcon:{width:48,height:48}}),Re=function(e){var t=e.open,n=e.onClose,a=e.onSelect,o=_e();return r.a.createElement(Pe,{title:"Create from Template",open:t,onClose:n},se.map((function(e){return r.a.createElement(z.a,{key:e.name,onClick:function(){return a(e)},className:o.bigButton},r.a.createElement("div",null,r.a.createElement("div",null,e.name),r.a.createElement("div",null,r.a.createElement(e.Icon,{className:o.bigIcon}))))})))},Ae=n(135),Be=n.n(Ae);window.posthogInitialized=!1;for(var Me=function(){if(!window.posthogInitialized){Be.a.init("dSrx1PbFd02XsxlLd7qNbeTxKZwwao2sclVmapyYlT4",{api_host:"https://posthog.universaldatatool.com",autocapture:!1}),window.posthog=Be.a;var e=window.location.origin;Be.a.capture("domain",{domain:e}),Be.a.people.set({domain:e}),window.posthogInitialized=!0}return Be.a},ze=Object(S.a)({container:{display:"flex",flexDirection:"column",backgroundColor:B.a[900],height:"100vh"},headerButton:{fontSize:12,backgroundColor:"#fff"},downloadIcon:{marginTop:2,width:18,height:18,marginRight:4,marginLeft:-6,color:B.a[700]},languageSelectionWrapper:{display:"flex",flexDirection:"column",textAlign:"center"}}),Ue=Object(A.a)("div")((function(e){var t=e.theme;return Object(O.a)({display:"flex",justifyContent:"center",flexGrow:1,color:"#fff",overflowY:"scroll",padding:100},t.breakpoints.down("sm"),{padding:50})})),Je=Object(A.a)("div")((function(e){e.theme;return{display:"flex",flexDirection:"column",width:"calc(100% - 32px)",marginLeft:16,maxWidth:1e3}})),Fe=Object(A.a)("div")({marginTop:20,fontSize:36,fontWeight:600,color:B.a[300]}),We=Object(A.a)("div")({fontSize:18,marginTop:8,color:B.a[500]}),He=Object(A.a)("div")({marginTop:48}),Ve=Object(A.a)("a")({display:"block",color:u.a[500],marginTop:4,cursor:"pointer",textDecoration:"none"}),Ge=Object(A.a)("div")({fontSize:24,marginBottom:8,color:B.a[500]}),qe=Object(A.a)("div")({height:100}),Ke=function(e){var t=e.onOpenTemplate,n=ze(),o=Me(),i=Object(H.a)(),c=i.t,l=(i.i18n,Object(a.useState)(!1)),s=Object(g.a)(l,2),u=s[0],m=s[1];return r.a.createElement("div",{className:n.container},r.a.createElement(Re,{open:u,onSelect:function(e){o.capture("template_clicked",{clicked_template:e.name}),t(e)},onClose:function(){return m(!1)}}),r.a.createElement(pe,null),r.a.createElement(Ue,null,r.a.createElement(Je,null,r.a.createElement(be.a,{container:!0},r.a.createElement(be.a,{xs:6,item:!0},r.a.createElement(Fe,null,"Universal Data Tool"),r.a.createElement(We,null,c("universaldatatool-description"))),r.a.createElement(be.a,{xs:3}),r.a.createElement(be.a,{xs:6,item:!0},r.a.createElement(He,null,r.a.createElement(Ge,null,"Start"),r.a.createElement(Ve,{onClick:function(){return m(!0)}},c("start-from-template")))),r.a.createElement(be.a,{xs:6,item:!0}),r.a.createElement(be.a,{xs:12,item:!0},r.a.createElement(qe,null))))))},Ye=n(66),Ze=n(193),$e=n.n(Ze),Qe=n(343),Xe=n(124),et=n.n(Xe),tt=Object(S.a)({textField:{marginLeft:8}}),nt=function(e){var t=e.value,n=e.onChange,o=tt(),i=Object(a.useState)({editing:!1,newValue:t||""}),c=Object(g.a)(i,2),l=c[0],s=l.editing,u=l.newValue,m=c[1];return Object(a.useEffect)((function(){et()(u)||"unnamed"===u?m({editing:s,newValue:t}):m({editing:s,newValue:u})}),[u,s,t]),Object(a.useEffect)((function(){if(s){var e=function(e){"Enter"===e.key&&(n(u),m({editing:!1}))};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}}),[s,u,n]),Object(a.useEffect)((function(){if(u){if(s){var e=setTimeout((function(){n(u),m({editing:!1})}),t===u?1e4:2e3);return function(){return clearTimeout(e)}}return function(){}}}),[s,u,t,n]),r.a.createElement(Qe.a,{className:o.textField,label:"File Name",variant:"outlined",size:"small",InputProps:{inputProps:{style:{color:"#000"}}},onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),e.target.blur())},onKeyPress:function(e){e.stopPropagation()},onChange:function(e){m({editing:!0,newValue:e.target.value})},value:u||""})},at=n(45),rt=n(388),ot=n(361),it=n.n(ot),ct=n(127),lt=n.n(ct),st=n(246),ut=n.n(st),mt=n(24),dt=n(797),ft=n(196),pt=n.n(ft),bt=n(64),ht=n.n(bt),gt=n(800),vt=n(363),Ot=n.n(vt),Et=n(289),jt=n(290),wt=n(118),yt=n(291),St=n(120),Ct=n(117),xt=n(25),kt=Object(f.a)(Object(f.a)({},B.a),{},{isFaded:!0}),It=[u.a,Et.a,M.a,jt.a,wt.a,yt.a,St.a,Ct.a],Tt=Object(f.a)(Object(f.a)({},xt),{},{complete:u.a,incomplete:kt,faded:kt,review:Et.a}),Nt=function(e){return Tt[e]||It[Ot()(e)*It.length]},Dt=Object(A.a)("div")({flexWrap:"wrap",height:"100%",boxSizing:"border-box",display:"flex",flexDirection:"column"}),Lt=Object(A.a)("div")({fontSize:24,color:B.a[500],padding:30,textAlign:"center"}),Pt=Object(A.a)("div")((function(e){var t=e.color;return{color:"#fff",fontVariantNumeric:"tabular-nums",margin:4,padding:4,backgroundColor:t[500],display:"inline-flex",fontSize:14,fontWeight:500,textAlign:"center",justifyContent:"center",minWidth:"3em",borderRadius:3,cursor:"pointer",userSelect:"none",transition:"box-shadow 200ms ease, transform 200ms ease, background-color 200ms ease","&:hover":{backgroundColor:t[700]},"&.selected":{backgroundColor:t[700],boxShadow:"0px 0px 2px 1px ".concat(t.A200),transform:"scale(1.05,1.05)"}}})),_t=Object(a.memo)((function(e){var t=e.index,n=e.onClick,a=e.completed,o=e.selected,i=e.onMouseDown,c=e.onMouseUp,l=e.onMouseEnter,s=e.brush;return r.a.createElement(Pt,{className:ht()({completed:a,selected:o}),onClick:function(){return n(t)},onMouseDown:function(){return i(t)},onMouseUp:function(){return c(t)},onMouseEnter:function(){return l(t)},color:Nt(s)},t)}),(function(e,t){return e.index===t.index&&e.completed===t.completed&&e.selected===t.selected&&e.brush===t.brush})),Rt=function(e){var t=e.count,n=e.completed,o=void 0===n?[]:n,i=e.samples,c=e.onClick,l=Object(dt.a)("samplesPerPage",100),s=Object(g.a)(l,2),u=s[0],m=s[1],d=Object(dt.a)("sampleOffset",0),f=Object(g.a)(d,2),p=f[0],b=f[1];Object(a.useEffect)((function(){p>t&&b(0)}),[b,p,t]);var h=Object(a.useReducer)((function(e,t){return null===t?null:"number"===typeof t?e?[Math.min(t,e[0]),Math.max(t+1,e[1])]:null:t}),null),v=Object(g.a)(h,2),O=v[0],E=v[1],j=Object(a.useCallback)((function(e){return E([e,e+1])}),[E]),w=Object(a.useCallback)((function(e){return E(e)}),[E]),y=Object(a.useCallback)((function(){}),[]),S=Object(a.useCallback)((function(e){1!==e.buttons&&E(null)}),[E]),C=Object(mt.a)(c);return r.a.createElement(Dt,{onMouseUp:S,onMouseEnter:S},0===t&&r.a.createElement(Lt,null,'No samples, try using "Import Toy Dataset" in Samples > Import'),r.a.createElement(he.a,{flexGrow:1},pt()(p,Math.min(t,p+u)).map((function(e){return r.a.createElement(_t,{onClick:C,key:e,index:e,completed:o[e],brush:o[e]?i[e].brush||"complete":"incomplete",selected:O&&e>=O[0]&&e<O[1],onMouseDown:j,onMouseEnter:w,onMouseUp:y})}))),r.a.createElement(gt.a,{rowsPerPageOptions:[100,250,500,1e3,2e3,1e4],component:"div",count:t,rowsPerPage:u,page:Math.floor(p/u),labelRowsPerPage:"Samples per Page:",onChangePage:function(e,t){return b(t*u)},onChangeRowsPerPage:function(e){return m(+e.target.value)}}))},At=n(370),Bt=n.n(At),Mt=n(371),zt=n.n(Mt),Ut=n(369),Jt=n.n(Ut),Ft=n(366),Wt=n.n(Ft),Ht=n(368),Vt=n.n(Ht),Gt=n(367),qt=n.n(Gt),Kt=n(244),Yt=Object(A.a)("div")({marginTop:8,marginBottom:16}),Zt=Object(A.a)("textarea")({width:"100%",minHeight:300}),$t=Object(A.a)("div")({color:ke.a[600],padding:16}),Qt=[{label:"Auto Detect File Type",value:"auto_detect"},{label:"Image URLs",value:"images"}],Xt=function(e){var t=e.open,n=e.onClose,o=e.onAddSamples,i=Object(a.useState)(""),c=Object(g.a)(i,2),l=c[0],s=c[1],u=Object(a.useState)("auto_detect"),m=Object(g.a)(u,2),d=m[0],f=m[1],p=Object(a.useState)(""),b=Object(g.a)(p,2),h=b[0],v=b[1];return r.a.createElement(Pe,{title:"Paste Urls",open:t,onClose:n,actions:[{text:"Add Samples",onClick:function(){try{o(l.split("\n").map((function(e){return e.trim()})).filter(Boolean).map((function(e){if("images"===d)return{imageUrl:e};var t=e.replace(/\?.*/g,"").split(".").slice(-1)[0];switch(e.includes("gstatic.com/images")&&(t="jpg"),t.toLowerCase()){case"png":case"jpg":case"gif":case"jpeg":case"bmp":return{imageUrl:e};case"pdf":return{pdfUrl:e};case"mp3":case"wav":return{audioUrl:e};default:throw new Error('extension not recognized: "'.concat(t,'" in "').concat(e,'"'))}})).filter(Boolean))}catch(e){v(e.toString())}}}]},r.a.createElement(Yt,null,r.a.createElement(Kt.default,{options:Qt,defaultValue:Qt[0],onChange:function(e){f(e.value)}})),h&&r.a.createElement($t,null,h),r.a.createElement(Zt,{onChange:function(e,t){return s(e.target.value)},placeholder:"Paste URLs here\nOne URL per line"}))},en=n(26),tn=n.n(en),nn=n(390),an=Object(A.a)("textarea")({width:"100%",minHeight:300}),rn=Object(A.a)("div")({fontSize:24,color:B.a[600],textAlign:"center",padding:48}),on=function(){return null},cn=function(e){var t=e.content,n=e.onChangeContent,o=e.placeholder,i=Object(mt.a)((function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result;n(t)},t.readAsText(e[0])})),c=Object(a.useState)(0),l=Object(g.a)(c,2),s=l[0],u=l[1],m=Object(mt.a)((function(e){Date.now()-s<400&&f().onClick(e),u(Date.now())})),d=Object(nn.a)({onDrop:i}),f=d.getRootProps,p=d.getInputProps,b=d.isDragActive;return r.a.createElement("div",Object.assign({},f(),{onClick:on}),r.a.createElement("input",p()),b?r.a.createElement(rn,null,"Drop the text or csv file here."):r.a.createElement(an,{value:t,onChange:function(e,t){return n(e.target.value)},onClick:m,placeholder:o}))},ln=n(200),sn=n.n(ln),un={},mn=0,dn=Object.entries({imageUrl:["image_url","image_urls","image","image_src","img_url","img","img_src"],document:["text"]});mn<dn.length;mn++){var fn,pn=Object(g.a)(dn[mn],2),bn=pn[0],hn=pn[1],gn=Object(at.a)(hn);try{for(gn.s();!(fn=gn.n()).done;){var vn=fn.value;un[vn]=bn}}catch(no){gn.e(no)}finally{gn.f()}}var On=function(e){for(var t in e){var n=t.toLowerCase().replace(/ /g,"_"),a=un[n];a&&(e[a]=e[t],delete e[t])}return e},En=function(e){var t=sn.a.fromCSV(e,{derivePath:function(){return"samples.*"}});if(!t.samples)throw new Error("No samples");return{interface:t.interface,taskOutput:t.samples.map((function(e){return e.output})),samples:t.samples.map(On).map((function(e){return delete e.output,e}))}},jn=Object(A.a)("div")({fontFamily:"Inter",marginBottom:20,"& a":{color:u.a[500]}}),wn=Object(A.a)("div")({color:ke.a[500],whiteSpace:"pre-wrap",marginBottom:20}),yn=function(e){var t=e.open,n=e.onClose,o=e.onAddSamples,i=Object(a.useState)(null),c=Object(g.a)(i,2),l=c[0],s=c[1],u=Object(a.useState)(""),m=Object(g.a)(u,2),d=m[0],f=m[1];return r.a.createElement(Pe,{open:t,onClose:n,title:"Import JSON/CSV Samples",actions:[{text:"Add Samples",onClick:function(){var e,t;s(null);try{var n=Object(g.a)(JSON.parse(d).samples,2);e=n[0],t=n[1]}catch(r){try{var a=En(d);e=a.samples,t=a.taskOutput}catch(i){return console.log({message:"CSV/JSON Error Stacks",jsonError:r.stack,csvError:i.stack}),void s("JSON did not parse. CSV did not parse.\n\nJSON Error: ".concat(r.toString(),"\nCSV Error: ").concat(i.toString()))}}e&&0!==e.length?o(e,t):s("No task data found")}}]},r.a.createElement(jn,null,"See the"," ",r.a.createElement("a",{href:"https://github.com/UniversalDataTool/udt-format"},"UDT JSON format")," ","or the"," ",r.a.createElement("a",{href:"https://github.com/UniversalDataTool/udt-format"},"UDT CSV format")," ","for formatting details. Or take a look at a"," ",r.a.createElement("a",{href:"https://github.com/UniversalDataTool/udt-format/blob/master/SAMPLE.udt.json"},"sample JSON")," ","or"," ",r.a.createElement("a",{href:"https://github.com/UniversalDataTool/udt-format/blob/master/SAMPLE.udt.csv"},"sample CSV")," ","file."),r.a.createElement(wn,null,l),r.a.createElement(cn,{content:d,onChangeContent:f,placeholder:"Paste CSV/JSON here. The file should be in the UDT JSON/CSV format.\n\nYou can also drag a json or csv file here (double click to open file dialog)"}))},Sn=n(789),Cn=n(792),xn=n(787),kn=n(788),In=n(790),Tn=n(791),Nn=[{name:"Elon Musk Tweets",type:"text",size:2800},{name:"Cats",type:"image",size:360},{name:"VR Hand Pinching",type:"image",size:20517},{name:"AI Generated Faces",type:"image",size:1999},{name:"Text to Speech Audio",type:"audio",size:200}];function Dn(e){return Ln.apply(this,arguments)}function Ln(){return(Ln=Object(h.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name.toLowerCase().replace(/ /g,"_")+".udt.json",a="https://s3.amazonaws.com/datasets.workaround.online/".concat(n),e.next=4,fetch(a).then((function(e){return e.json()})).then((function(e){return e.samples||e.taskData}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Pn=Object(A.a)(z.a)({}),_n=function(e){var t=e.onClose,n=e.onAddSamples,a=e.open,o=Object(H.a)().t;return r.a.createElement(Pe,{onClose:t,open:a,title:"Import Toy Dataset"},r.a.createElement(kn.a,null,r.a.createElement(Sn.a,null,r.a.createElement(In.a,null,r.a.createElement(Tn.a,null,r.a.createElement(xn.a,null,o("Name")),r.a.createElement(xn.a,null,o("Type")),r.a.createElement(xn.a,null,o("Size")),r.a.createElement(xn.a,null,o("Actions")))),r.a.createElement(Cn.a,null,Nn.map((function(e){return r.a.createElement(Tn.a,{key:e.name},r.a.createElement(xn.a,null,e.name),r.a.createElement(xn.a,null,e.type),r.a.createElement(xn.a,null,e.size),r.a.createElement(xn.a,null,r.a.createElement(Pn,{"data-import-toy-dataset-name":e.name,onClick:Object(h.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=n,t.next=3,Dn(e);case 3:t.t1=t.sent,(0,t.t0)(t.t1);case 5:case"end":return t.stop()}}),t)}))),variant:"outlined"},o("import"))))}))))))},Rn=Object(A.a)(z.a)({width:240,height:140,display:"inline-flex",flexDirection:"column","&.disabled":{backgroundColor:B.a[200]},margin:8,"& .icon":{width:48,height:48,color:B.a[600],"&.disabled":{color:B.a[400]}}}),An=(Object(A.a)("div")({fontSize:11,fontWeight:"bold",color:B.a[600],"&.disabled":{color:B.a[500]}}),Object(a.createContext)()),Bn=function(e){var t=e.Icon,n=e.desktopOnly,a=e.isDesktop,o=e.children,i=e.dialog,c=e.authConfiguredOnly,l=e.authConfig,s=e.signedInOnly,u=e.user,m=e.onlySupportType,d=e.type,f=Me(),p=n?{disabled:!a,disabledText:"DESKTOP ONLY"}:m&&!m.includes(d)?{disabled:!0,disabledText:"DOESN'T SUPPORT THIS INTERFACE"}:c?s?{disabled:et()(u),disabledText:"MUST BE SIGNED IN"}:{disabled:et()(l),disabledText:"AUTH MUST BE CONFIGURED"}:{disabled:!1,disabledText:""},b=p.disabled;return r.a.createElement(An.Consumer,null,(function(e){var n=e.onChangeDialog;return r.a.createElement(Rn,{onClick:function(){f.capture("import_button_clicked",{import_button:i}),n(i)},className:ht()({disabled:b}),variant:"outlined",disabled:b},r.a.createElement("div",null,r.a.createElement(t,{className:ht()("icon",{disabled:b})}),r.a.createElement("div",null,o)))}))},Mn=function(e){e.file,e.onChangeFile;var t=e.dataset,n=e.onChangeDataset,o=e.isDesktop,i=e.authConfig,c=e.user,l=Object(H.a)().t,s=Object(a.useState)(),u=Object(g.a)(s,2),m=u[0],d=u[1],f=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=3;break;case 3:return e.abrupt("return",d(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){return d(null)},v=Object(mt.a)(function(){var e=Object(h.a)(b.a.mark((function e(a){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(Object(en.setIn)(t,["samples"],(t.samples||[]).concat(a))),p();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return r.a.createElement(An.Provider,{value:{onChangeDialog:f}},r.a.createElement("div",null,r.a.createElement(Bn,{isDesktop:o,dialog:"paste-image-urls",Icon:Wt.a,authConfig:i,signedInOnly:!1,user:c},l("paste-urls")),r.a.createElement(Bn,{isDesktop:o,dialog:"import-toy-dataset",Icon:qt.a},l("import-toy-dataset")),r.a.createElement(Bn,{dialog:"import-csv-json",Icon:Vt.a},l("import-from")," CSV / JSON"),r.a.createElement(Xt,{open:"paste-image-urls"===m,onClose:p,onAddSamples:v}),r.a.createElement(_n,{open:"import-toy-dataset"===m,onClose:p,onAddSamples:v}),r.a.createElement(yn,{open:"import-csv-json"===m,onClose:p,onAddSamples:v})))},zn=Object(A.a)("div")({padding:16,height:"100%",display:"flex",flexDirection:"column",boxSizing:"border-box"}),Un=Object(A.a)("div")({fontSize:14,color:B.a[600],display:"flex",justifyContent:"flex-end",alignItems:"center",flexGrow:1}),Jn=Object(A.a)("div")({padding:8,border:"#888 solid 1px",borderTop:"none",borderRadius:4,borderTopLeftRadius:0,borderTopRightRadius:0,boxShadow:"inset 0 3px 3px rgba(0,0,0,0.2)"}),Fn=Object(A.a)("div")({fontSize:11,fontWeight:"bold"}),Wn=Object(A.a)("pre")({whiteSpace:"pre-wrap",fontSize:11}),Hn=function(e){var t=e.data,n=t.annotation,a=Object(rt.a)(t,["annotation"]);return r.a.createElement(Jn,null,r.a.createElement(be.a,{spacing:2,container:!0},r.a.createElement(be.a,{item:!0,xs:6},r.a.createElement(Fn,null,"samples[",t.index,"]:"),r.a.createElement(Wn,null,JSON.stringify(a,null,"  "))),r.a.createElement(be.a,{item:!0,xs:6},r.a.createElement(Fn,null,"samples[",t.index,"].annotation:"),r.a.createElement(Wn,null,JSON.stringify(n,null,"  ")))))},Vn=function(e){var t=e.file,n=e.dataset,o=e.openSampleInputEditor,i=e.openSampleLabelEditor,c=e.deleteSample,l=e.onChangeDataset,s=e.onChangeFile,u=e.authConfig,m=e.user,d=Object(a.useState)(0===(n.samples||[]).length?"import":window.localStorage.lastSampleTab||"grid"),p=Object(g.a)(d,2),b=p[0],h=p[1],v=function(e){h(e),window.localStorage.lastSampleTab=e},O=Object(a.useMemo)((function(){if(!n.samples)return[];var e,t=[{name:"Index",selector:"index",sortable:!0}],a=new Set,l=Object(at.a)(n.samples);try{for(l.s();!(e=l.n()).done;){var s=e.value,u=function(e){a.has(e)||(t.push({name:e,selector:e,cell:function(t){return"object"!==typeof t[e]?t[e]:JSON.stringify(t[e]).slice(0,30)+"..."}}),a.add(e))};for(var m in s)u(m)}}catch(no){l.e(no)}finally{l.f()}return t.push({name:"Edit",button:!0,cell:function(e){return r.a.createElement(P.a,{raised:!0,onClick:function(){return o(e.index)}},r.a.createElement(lt.a,{style:{width:20,height:20}}))}}),t.push({name:"Label",button:!0,cell:function(e){return r.a.createElement(P.a,{raised:!0,onClick:function(){return i(e.index)}},r.a.createElement(N.a,{style:{width:20,height:20}}))}}),t.push({name:"Delete",button:!0,cell:function(e){return r.a.createElement(P.a,{raised:!0,primary:!0,onClick:function(){return c(e.index)}},r.a.createElement(ut.a,{style:{width:20,height:20}}))}}),t}),[n.samples,c,o,i]),E=Object(a.useMemo)((function(){return n.samples?n.samples.map((function(e,t){return Object(f.a)(Object(f.a)({},e),{},{index:t})})):[]}),[n.samples]);return r.a.createElement(zn,null,r.a.createElement(he.a,{display:"flex"},r.a.createElement(w.a,{value:b,onChange:function(e,t){return v(t)}},r.a.createElement(y.a,{icon:r.a.createElement(Jt.a,null),label:"Import",value:"import"}),r.a.createElement(y.a,{icon:r.a.createElement(Bt.a,null),label:"Grid",value:"grid"}),r.a.createElement(y.a,{icon:r.a.createElement(zt.a,null),label:"Table",value:"table"})),r.a.createElement(Un,null,(n.samples||[]).length," Samples",r.a.createElement("br",null),(n.samples||[]).filter((function(e){return e.annotation})).length," Labels")),r.a.createElement(he.a,{paddingTop:2}),r.a.createElement(he.a,{flexGrow:1},"import"===b&&r.a.createElement(Mn,{file:t,onChangeFile:function(e){return s(e)},onImportPageShouldExit:function(){return v("grid")},onChangeDataset:function(e){return l(e)},dataset:n,authConfig:u,user:m}),"grid"===b&&r.a.createElement(Rt,{count:(n.samples||[]).length,samples:n.samples||[],completed:(n.samples||[]).map((function(e){return Boolean(e.annotation)})),onClick:function(e){i(e)}}),"table"===b&&r.a.createElement(it.a,{title:"Samples",expandableRowsComponent:r.a.createElement(Hn,null),expandableRows:!0,dense:!0,columns:O,data:E,pagination:!0,paginationPerPage:10,paginationRowsPerPageOptions:[10,20,25,50,100,200]})))},Gn=n(372),qn=n.n(Gn),Kn={questions:[{name:"multiple",title:"Allow multiple classifications per image?",type:"boolean"},{name:"labels",title:"Labels",description:"Classifications or tags to be labeled.",type:"matrixdynamic",columns:[{cellType:"text",name:"id",title:"id"},{cellType:"text",name:"description",title:"Description (optional)"}]}]},Yn=function(e){var t=e.iface,n=e.onChange,o=Object(a.useMemo)((function(){return{allowMultiple:!1,labels:(t.labels||[]).map((function(e){return"string"===typeof e?{id:e,description:e}:e}))||[]}}),[t.labels]);return r.a.createElement(qn.a,{noActions:!0,variant:"flat",defaultAnswers:o,onQuestionChange:function(e,a,r){n(Object(en.setIn)(t,[e],a))},form:Kn})},Zn=n(293),$n=n(292),Qn=n(344),Xn=n(376),ea=n.n(Xn),ta=n(385),na=Object(A.a)("div")({fontSize:24,fontWeight:"bold"}),aa=function(e){var t=e.children,n=e.onNext,o=e.onPrev,i=e.currentSampleIndex,c=void 0===i?0:i,l=e.numberOfSamples,s=void 0===l?1:l,u=e.globalSampleIndex,m=void 0===u?1:u,d=e.titleContent,f=e.onClickHeaderItem,p=Object(a.useMemo)((function(){return[(c>0||o)&&{name:"Prev",onClick:o},(s>c+1||n)&&{name:"Next",onClick:n},{name:"Save"}].filter(Boolean)}),[c,s,n,o]);return r.a.createElement(ta.a,{headerLeftSide:void 0===d?r.a.createElement(he.a,{paddingLeft:2,fontWeight:"bold"},r.a.createElement(na,null,"Sample"," ",s>1?"".concat(c+1," / ").concat(s):"".concat(m))):d,onClickHeaderItem:f,headerItems:p,iconSidebarItems:[],rightSidebarItems:[]},r.a.createElement(he.a,{padding:2,style:{width:"100%"}},t))},ra=[u.a[600],M.a[600],ke.a[600],Et.a[600],wt.a[600],Zn.a[600],$n.a[600],Ct.a[600],u.a[600],yt.a[600],jt.a[600]],oa="abcdefghijklmnopqrstuvwxyz1234567890".split(""),ia=function(e){var t=e.id.split("").reduce((function(e,t,n){return e+(oa.indexOf(t)+1)}),0);return ra[t%ra.length]},ca=Object(A.a)("div")({maxWidth:"100vw",display:"flex",flexDirection:"column"}),la=Object(A.a)("div")({position:"relative",display:"flex",flexGrow:1}),sa=Object(A.a)("img")({display:"inline-block",position:"absolute",left:0,top:0,width:"100%",height:"100%",objectFit:"contain"}),ua=Object(A.a)("div")({paddingLeft:50,paddingRight:50,marginTop:8,textAlign:"center",flexShrink:0}),ma=Object(A.a)(z.a)({margin:8,color:"#fff",fontSize:18,paddingRight:16,transition:"transform 50ms ease"}),da={},fa=[],pa=function(e){var t=e.sampleIndex,n=e.interface,o=e.samples,i=void 0===o?fa:o,c=e.containerProps,l=void 0===c?da:c,s=e.onSaveTaskOutputItem;if(n.availableLabels&&!n.labels&&(n.labels=n.availableLabels),!n.labels)throw new Error("No labels defined. Add some labels in Setup to continue.");var u=Object(a.useState)(0),m=Object(g.a)(u,2),d=m[0],f=m[1],p=Object(a.useState)(null),b=Object(g.a)(p,2),h=b[0],v=b[1],O=Object(a.useState)(fa),E=Object(g.a)(O,2),j=E[0],w=E[1],y=Object(a.useMemo)((function(){return n.labels.map((function(e){return"string"===typeof e?{id:e,description:e}:e}))}),[n.labels]),S=Object(mt.a)((function(){l.onExit&&l.onExit()})),C=Object(mt.a)((function(){l.onExit&&l.onExit("go-to-next")})),x=Object(mt.a)((function(e){s(d,e||j),d!==i.length-1?f(d+1):l.onExit&&l.onExit("go-to-next")})),k=Object(mt.a)((function(){d>0?f(d-1):l.onExit&&l.onExit("go-to-previous")}));Object(a.useEffect)((function(){var e=setTimeout((function(){v(null)}),100);return function(){return clearTimeout(e)}}),[h]);var I=Object(mt.a)((function(e){var t;v(e),t=(j||[]).includes(e.id)?ea()(j,e.id):n.allowMultiple?j.concat([e.id]):e.id,w(t),!n.allowMultiple&&t.length>0&&x(t)}));Object(a.useEffect)((function(){var e=i[d].annotation;e||(e=[]),"string"===typeof e&&(e=[e]),w(e)}),[d,t,i]);var T=Object(a.useMemo)((function(){var e,t={" ":x,backspace:k,enter:S,rightarrow:x,leftarrow:k},n={},a=Object(at.a)(y);try{var r=function(){var a=e.value,r=a.id.split("").filter((function(e){return oa.includes(e)})).find((function(e){return!t[e.toLowerCase()]}));if(!r)return"continue";t[r]=function(){return I(a)},n[a.id]=r};for(a.s();!(e=a.n()).done;)r()}catch(no){a.e(no)}finally{a.f()}return[t,n]}),[y,I,S,x,k]),N=Object(g.a)(T,2),D=N[0],L=N[1];return Object(a.useEffect)((function(){var e=function(e){var t=e.key.toLowerCase();D[t]&&D[t]()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[D]),r.a.createElement(aa,{onNext:C,onPrev:k,onClickHeaderItem:S,numberOfSamples:i.length,currentSampleIndex:d,globalSampleIndex:t},r.a.createElement(ca,{style:{height:l.height||"calc(100% - 70px)",minHeight:600}},r.a.createElement(la,null,r.a.createElement(sa,{src:i[d].imageUrl})),r.a.createElement(ua,null,y.map((function(e){return r.a.createElement(ma,{key:e.id,onClick:function(){return I(e)},style:{backgroundColor:ia(e),transform:h===e?"scale(1.1,1.1)":void 0}},r.a.createElement(Qn.a,{style:{color:"#fff"},checked:j.includes(e.id)}),e.id,L[e.id]?" (".concat(L[e.id],")"):"")})))))},ba=n(93),ha=Object(S.a)({root:{padding:50,textAlign:"center"},title:{margin:50},explain:{}}),ga=function(e){var t=e.title,n=e.description,a=e.children,o=ha();return r.a.createElement("div",{className:o.root},r.a.createElement(ba.a,{variant:"h4",component:"div",className:o.title},t),r.a.createElement(ba.a,{variant:"h6",component:"div",className:o.explain},n||a))},va=function(){return r.a.createElement(ga,{title:"No Samples to Show"},"Make sure that ",r.a.createElement("code",null,"samples")," is defined and not empty.",r.a.createElement("br",null),r.a.createElement("br",null),"Need help setting up? ")},Oa=function(e){var t=e.dataset,n=e.onExit,o=e.hideHeader,i=e.hideDescription,c=e.datasetName,l=e.requireCompleteToPressNext,s=e.onSaveTaskOutputItem,u=e.height,m=e.onClickSetup,d=Object(H.a)().t,f=Object(a.useMemo)((function(){return{hideHeader:o,hideDescription:i,datasetName:c,requireCompleteToPressNext:l,onExit:n,height:u}}),[o,i,l,c,u,n]);if(!t||!t.interface.type)return r.a.createElement(ga,{title:"Set up your project to begin labeling",description:r.a.createElement("p",null,d("universal-data-viewer-interface-warning"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(z.a,{color:"primary",variant:"contained",onClick:m},d("setup-project")))});if(!t.samples||0===t.samples.length)return r.a.createElement(va,null);switch(t.interface.type){case"image_classification":return r.a.createElement(pa,Object.assign({containerProps:f},t,{onExit:n,onSaveTaskOutputItem:s}));default:return'"'.concat(t.interface.type,'" not supported')}},Ea=n(129),ja=n(130),wa=n(204),ya=n(202),Sa=n(62),Ca=n(389);Sa.e({dsn:"https://bc19fbac222243f08f0abaf6d66f2034@sentry.io/5182632",whitelistUrls:["https://universaldatatool.com","^file:?:"]});var xa=Ca,ka=function(e){Object(wa.a)(n,e);var t=Object(ya.a)(n);function n(e){var a;return Object(Ea.a)(this,n),(a=t.call(this,e)).state={hasError:!1},a}return Object(ja.a)(n,[{key:"componentDidCatch",value:function(e,t){var n=this;xa.withScope((function(a){a.setExtras(t);var r=xa.captureException(e);n.setState({eventId:r})}))}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(ga,{title:"An error occurred loading the labeling interface",description:this.state.errorString}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return console.error("The following error occurred when loading a labeling interface:",e),{hasError:!0,errorString:e.toString()}}}]),n}(r.a.Component),Ia=function(){},Ta=Object(A.a)("div")({padding:24,"&.emptyState":{textAlign:"center",backgroundColor:u.a[800],minHeight:"70vh",padding:64,"& .bigText":{textAlign:"left",fontSize:48,color:"#fff",fontWeight:"bold",marginBottom:48}}}),Na=Object(A.a)(z.a)({padding:10,width:200,height:150,boxShadow:"0px 3px 5px rgba(0,0,0,0.3)",margin:12,backgroundColor:"#fff","& .bigIcon":{marginTop:16,width:64,height:64},"&:hover":{backgroundColor:"#fff"}}),Da=Object(A.a)("div")({fontSize:18,textAlign:"center",fontWeight:"bold",color:B.a[500],paddingTop:30,paddingBottom:50}),La=Object(A.a)(z.a)({margin:8,"& .icon":{marginRight:8,color:"#888"},alignItems:"center",justifyContent:"center","&.selected":{backgroundColor:u.a[500],color:"#fff","& .icon":{color:"#fff"}}}),Pa=Object(A.a)("div")({fontWeight:"bold",textTransform:"uppercase",fontSize:12,paddingLeft:8,marginBottom:8,marginTop:16,color:B.a[700]}),_a=Object(A.a)("div")({display:"flex",justifyContent:"space-around",mouseEvents:"none",padding:16}),Ra=Object(A.a)("div")({display:"flex",width:"100%",height:600}),Aa=function(e){var t=e.currentlySelected,n=e.onChange;return se.map((function(e){return r.a.createElement(La,{key:e.dataset.interface.type||"empty",className:t===e.dataset.interface.type?"selected":"",variant:"outlined",onClick:function(){t!==e.dataset.interface.type&&n(e.dataset.interface.type)}},r.a.createElement(e.Icon,{className:"icon"}),e.name)}))},Ba=function(e){var t=e.iface,n=void 0===t?{}:t,o=e.onChange,i=(e.onClickEditJSON,e.isNested),c=void 0!==i&&i,l=Object(a.useState)(0),s=Object(g.a)(l,2),u=s[0],m=s[1],d=Object(a.useState)(!1),f=Object(g.a)(d,2),p=f[0],b=f[1],h=Object(mt.a)((function(){m(Date.now()),o.apply(void 0,arguments)}));return Object(a.useEffect)((function(){if(!(Date.now()-u>1e3)){b(!0);var e=setTimeout((function(){b(!1)}),1e3);return function(){clearTimeout(e)}}}),[u]),n.type&&"empty"!==n.type?r.a.createElement(Ta,null,r.a.createElement(Pa,null,"Interface Type"),r.a.createElement(Aa,{currentlySelected:n.type,onChange:function(e){h(se.map((function(e){return e.dataset.interface})).find((function(t){return t.type===e}))||{})}}),r.a.createElement(be.a,{container:!0},r.a.createElement(be.a,{item:!0,hidden:c,xs:12,lg:6},r.a.createElement(Pa,null,"Preview"),r.a.createElement(_a,null,r.a.createElement(Ra,{style:{opacity:p?.5:1,height:"100%"}},r.a.createElement(ka,{key:u},r.a.createElement(Oa,{key:u,height:600,onExit:Ia,onSaveTaskOutputItem:Ia,dataset:{interface:n,samples:[le[n.type].dataset.samples[0]]}}))))),r.a.createElement(be.a,{item:!0,xs:12,lg:c?12:6},r.a.createElement(Pa,null,"Options"),r.a.createElement(he.a,{paddingTop:2}),!n.type&&r.a.createElement(Da,null,"Select a Type"),"image_classification"===n.type&&r.a.createElement(Yn,{iface:n,onChange:h})))):r.a.createElement(Ta,{className:"emptyState"},r.a.createElement("div",{className:"bigText"},"Choose an Interface:"),se.filter((function(e){return"Empty"!==e.name})).map((function(e){return r.a.createElement(Na,{key:e.name,onClick:function(){return h(e.dataset.interface)}},r.a.createElement("div",null,r.a.createElement("div",null,e.name),r.a.createElement("div",null,r.a.createElement(e.Icon,{className:"bigIcon"}))))})))},Ma=Object(A.a)("div")({margin:16,padding:16,border:"1px solid #ccc",borderRadius:4,boxShadow:"0px 2px 2px rgba(0,0,0,0.1)"}),za=n(793),Ua=[{id:"switch_to_label",description:"Go to Labels Tab",binding:"shift+3"},{id:"switch_to_setup",description:"Go to Setup Tab",binding:"shift+1"},{id:"switch_to_samples",description:"Go to Samples Tab",binding:"shift+2"},{id:"select_tool",description:"Switch to the Select Tool",binding:"escape"},{id:"zoom_tool",description:"Select the Zoom Tool",binding:"z"},{id:"create_point",description:"Create a point"},{id:"create_bounding_box",description:"Create a bounding box",binding:"b"},{id:"pan_tool",description:"Select the Pan Tool",binding:"p"},{id:"create_polygon",description:"Create a Polygon"},{id:"create_pixel",description:"Create a Pixel Mask"},{id:"save_and_previous_sample",description:"Save and go to previous sample",binding:"a"},{id:"save_and_next_sample",description:"Save and go to next sample",binding:"d"},{id:"save_and_exit_sample",description:"Save and exit current sample"},{id:"exit_sample",description:"Exit sample without saving"}],Ja=Object(a.createContext)({hotkeys:Ua,changeHotkey:function(e,t){return null}}),Fa=function(){return Object(a.useContext)(Ja)},Wa=function(e){var t=e.children,n=Ga(),o=n.fromConfig,i=n.setInConfig,c=Object(a.useMemo)((function(){return Ua.map((function(e){return o("hotkeys.".concat(e.id))?Object(f.a)(Object(f.a)({},e),{},{binding:o("hotkeys.".concat(e.id))}):e}))}),[o]),l=Object(a.useMemo)((function(){var e,t={},n=Object(at.a)(c);try{for(n.s();!(e=n.n()).done;){var a=e.value,r=a.id,o=a.binding;o&&(t[r]=o)}}catch(no){n.e(no)}finally{n.f()}return t}),[c]),s=Object(a.useMemo)((function(){return{hotkeys:c,keyMap:l,clearHotkeys:function(){var e,t=Object(at.a)(c);try{for(t.s();!(e=t.n()).done;){var n=e.value.id;i("hotkeys.".concat(n),null)}}catch(no){t.e(no)}finally{t.f()}},changeHotkey:function(e,t){return i("hotkeys.".concat(e),t)}}}),[i,c,l]);return r.a.createElement(Ja.Provider,{value:s},t)},Ha=Object(Ye.a)(Ua.map((function(e){var t=e.id;return"hotkeys.".concat(t)}))),Va=Object(a.createContext)({appConfig:{},setAppConfig:function(e){},fromConfig:function(e){},setInConfig:function(e,t){}}),Ga=function(){return Object(a.useContext)(Va)},qa=function(e){var t=e.children,n=Object(dt.a)("app_config",{}),o=Object(g.a)(n,2),i=o[0],c=o[1],l=Object(a.useMemo)((function(){return{appConfig:i,setAppConfig:c,fromConfig:function(e){if(!Ha.includes(e))throw new Error('Unknown config key name "'.concat(e,'"'));return i[e]},setInConfig:function(e,t){if("string"!==typeof t&&"number"!==typeof t&&"boolean"!==typeof t&&void 0!==t&&null!==t)throw new Error('Config can only have boolean/strings/numbers/null/undefined, something tried to set appConfig["'.concat(e,'"] = ').concat(JSON.stringify(t)));if(!Ha.includes(e))throw new Error('Unknown config key name "'.concat(e,'"'));c(Object(f.a)(Object(f.a)({},i),{},Object(O.a)({},e,t)))}}}),[i,c]);return r.a.createElement(Va.Provider,{value:l},t)},Ka=Object(S.a)({table:{}}),Ya={marginLeft:8,width:16,height:16},Za=function(e){var t=e.open,n=e.onClose,o=e.onChangeHotkey,i=e.hotkeyList,c=e.onClearHotkeys,l=Ka(),s=Object(a.useState)(),u=Object(g.a)(s,2),m=u[0],d=u[1],f=Object(a.useState)({}),p=Object(g.a)(f,2),b=p[0],h=b.modifier,v=b.key,O=p[1];return Object(a.useEffect)((function(){if(m)return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)};function e(e){["shift","ctrl","cmd","alt"].includes(e.key.toLowerCase())&&O({modifier:e.key.toLowerCase(),key:v}),1===e.key.length&&O({modifier:h,key:e.key.toLowerCase()})}}),[m,v,h,O]),Object(a.useEffect)((function(){v&&(o(m,h?"".concat(h," + ").concat(v):v),O({}),d(null))}),[h,v,o,m]),r.a.createElement(Pe,{title:"Manage Keyboard Shortcuts",actions:[{text:"Clear Hotkeys",onClick:c}],open:t,onClose:n},r.a.createElement(kn.a,null,r.a.createElement(Sn.a,{className:l.table,"aria-label":"simple table"},r.a.createElement(In.a,null,r.a.createElement(Tn.a,null,r.a.createElement(xn.a,null,"Action"),r.a.createElement(xn.a,{align:"right"},"Keyboard Shortcut"))),r.a.createElement(Cn.a,null,i.map((function(e){return r.a.createElement(Tn.a,{key:e.description},r.a.createElement(xn.a,null,e.description),r.a.createElement(xn.a,{align:"right"},r.a.createElement(z.a,{onClick:function(){if(m!==e)return d(e),void O({})},style:{minWidth:0}},r.a.createElement("b",null,m===e?h||v?"<".concat(h?h+"+":"").concat(v||"???",">"):"<Press Any Key>":e.binding),r.a.createElement(lt.a,{style:Ya}))))}))))))},$a=Object(A.a)(z.a)({margin:8}),Qa=function(e){var t=e.onClickEditJSON,n=e.onClearLabelData,o=(Object(za.a)(),Me(),Ga()),i=(o.fromConfig,o.setInConfig,Fa()),c=i.hotkeys,l=i.changeHotkey,s=i.clearHotkeys,u=Object(a.useState)(!1),m=Object(g.a)(u,2),d=m[0],f=m[1],p=Object(H.a)().t;return r.a.createElement(he.a,{padding:2},r.a.createElement($a,{onClick:t,variant:"outlined"},p("added-json")),r.a.createElement($a,{onClick:function(){window.confirm("Are you sure you want to delete all your label data? Click OK to delete.")&&n()},variant:"outlined"},p("clear-labels")),r.a.createElement($a,{variant:"outlined",onClick:function(){var e=window.prompt("Input URL for new collaboration server (empty to use universaldatatool.com):",window.localStorage.getItem("CUSTOM_COLLABORATION_SERVER")||"");null!==e&&(window.localStorage.setItem("CUSTOM_COLLABORATION_SERVER",e),window.location.reload())}},p("custom-collobration-server")),r.a.createElement($a,{variant:"outlined",onClick:function(){f(!0)}},"Change/View Hotkeys"),r.a.createElement(Za,{open:d,hotkeyList:c,onClose:function(){return f(!1)},onClearHotkeys:s,onChangeHotkey:function(e,t){return l(e.id,t)}}))},Xa=function(e){var t=e.dataset,n=e.onChange,a=e.onClickEditJSON,o=e.onClearLabelData,i=t.interface;return r.a.createElement("div",null,r.a.createElement(Ba,{iface:i,onChange:n,onClickEditJSON:a,isNotNested:!0}),r.a.createElement(Ma,null,r.a.createElement(Pa,null,"Advanced"),r.a.createElement(Qa,{onClearLabelData:o,onClickEditJSON:a})))},er=function(e){var t=e.open,n=e.sampleIndex,o=e.sampleInput,i=e.onChange,c=e.onClose,l=Object(a.useState)(),s=Object(g.a)(l,2),u=s[0],m=s[1],d=Object(a.useState)(),f=Object(g.a)(d,2),p=f[0],b=f[1];return Object(a.useEffect)((function(){var e=JSON.stringify(o,null,"  ");e!==u&&(m(e),b(null))}),[n,o,u]),r.a.createElement(Pe,{open:t,onClose:c,title:"samples[".concat(n,"]")},r.a.createElement($e.a,{theme:"github",mode:"javascript",width:"100%",value:u,editorProps:{$blockScrolling:1/0},onChange:function(e){m(e),b(null);try{i(JSON.parse(e))}catch(t){b(t.toString())}}}),r.a.createElement(he.a,{color:"red"},p))},tr=n(794),nr=n(393),ar=Object(S.a)({root:{position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,alignItems:"flex-start",pointerEvents:"none"},msgBox:{display:"flex",backgroundColor:u.a[700],fontSize:12,color:"#fff",padding:4,marginBottom:4,boxShadow:"0px 3px 8px rgba(0,0,0,0.5)","&.warning":{backgroundColor:St.a[700]},"&.error":{backgroundColor:ke.a[700]}}}),rr=Object(a.createContext)({}),or=function(){return{addToast:Object(a.useContext)(rr).addToast}},ir=function(e){var t=e.children,n=Object(a.useReducer)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if("add"===t.type){var n="info"===t.messageType?2e3:(t.messageType,5e3);return e.concat([{id:Math.random().toString().split(".")[1],message:t.message,type:t.messageType,life:n,fullLife:n}])}return"tick"===t.type?e.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{life:e.life-100})})).filter((function(e){return e.life>0})):e}),[]),o=Object(g.a)(n,2),i=o[0],c=o[1],l=ar();Object(a.useEffect)((function(){if(0===i.length)return function(){};var e=setInterval((function(){c({type:"tick"})}),100);return function(){return clearInterval(e)}}),[i]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(rr.Provider,{value:{toasts:i,addToast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";return c({type:"add",message:e,messageType:t})}}},t),r.a.createElement("div",{className:l.root},i.map((function(e){return r.a.createElement(tr.a,{key:e.id,in:e.life<e.fullLife},r.a.createElement(nr.a,{in:e.life>600},r.a.createElement("div",{className:ht()(l.msgBox,e.type)},e.message)))}))))},cr=Object(A.a)("div")({}),lr=Object(A.a)("div")({display:"inline-flex",flexDirection:"column",margin:8}),sr=Object(A.a)("div")({fontSize:14,fontWeight:"bold",color:B.a[700]}),ur=Object(A.a)("div")({fontSize:32,marginTop:8}),mr=function(e){var t=e.stats;return r.a.createElement(cr,null,t.map((function(e){return r.a.createElement(lr,{key:e.name},r.a.createElement(sr,null,e.name),r.a.createElement(ur,null,e.value))})))},dr=n(257),fr=n.n(dr),pr=Object(A.a)("div")({padding:16,height:"100%",display:"flex",flexDirection:"column",boxSizing:"border-box"}),br=function(e){var t=e.dataset,n=e.onChangeDataset,o=e.singleSampleDataset,i=e.onChangeSingleSampleDataset,c=e.selectedBrush,l=void 0===c?"complete":c,s=e.onClickSetup,u=e.onChangeSampleTimeToComplete,m=e.sampleTimeToComplete,d=Object(a.useState)("label"),p=Object(g.a)(d,2),b=p[0],h=p[1],v=Me(),O=0;return t.samples&&t.samples.length>0&&(O=t.samples.map((function(e){return void 0!==e.annotation&&null!==e.annotation})).filter(Boolean).length/t.samples.length),Object(a.useEffect)((function(){"labelhelp"===b&&v.capture("label_help_clicked")}),[b,v]),o?r.a.createElement(ka,null,r.a.createElement(Oa,{datasetName:"Sample ".concat(o.sampleIndex),onSaveTaskOutputItem:function(e,a){var r=o.sampleIndex,c=Object(g.a)(o.samples,1)[0],s=t;s=Object(en.setIn)(s,["samples",r,"annotation"],a),c.brush===l||void 0===c.brush&&"complete"===l||(s=Object(en.setIn)(s,["samples",r,"brush"],l)),i(Object(en.setIn)(o,["samples",0,"annotation"],a)),n(s)},onExit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"nothing";o.startTime&&u(Date.now()-o.startTime);var n=o.sampleIndex;switch(e){case"go-to-next":if(n!==t.samples.length-1)return v.capture("next_sample",{interface_type:t.interface.type}),void i(Object(f.a)(Object(f.a)({},t),{},{samples:[t.samples[n+1]],sampleIndex:n+1,startTime:Date.now()}));break;case"go-to-previous":if(0!==n)return void i(Object(f.a)(Object(f.a)({},t),{},{samples:[t.samples[n-1]],sampleIndex:n-1,startTime:Date.now()}))}i(null)},dataset:o,onClickSetup:s})):r.a.createElement(pr,null,r.a.createElement(he.a,{display:"flex"},r.a.createElement(he.a,null,r.a.createElement(w.a,{value:b,onChange:function(e,t){return h(t)}},r.a.createElement(y.a,{icon:r.a.createElement(N.a,null),label:"Label",value:"label"}))),r.a.createElement(he.a,{flexGrow:1}),r.a.createElement(mr,{stats:[{name:"Percent Complete",value:Math.floor(100*O)+"%"},{name:"Time per Sample",value:fr()(new Date(Date.now()-m)).toString(1,1)},{name:"Estimated Remaining",value:fr()(new Date(Date.now()-m*(1-O)*(t.samples||[]).length)).toString(1,2)}]})),r.a.createElement(he.a,{flexGrow:1},"label"===b&&r.a.createElement(Rt,{count:(t.samples||[]).length,samples:t.samples||[],completed:(t.samples||[]).map((function(e){return Boolean(e.annotation)})),onClick:function(e){v.capture("open_sample",{interface_type:t.interface.type}),i(Object(f.a)(Object(f.a)({},t),{},{samples:[t.samples[e]],sampleIndex:e,startTime:Date.now()}))}})))},hr=(n(704),n(382)),gr=(n(706),n(708),Object(S.a)({headerButton:{color:"#fff"},saveIcon:{marginRight:4},editIcon:{marginLeft:4},container:{display:"flex",flexDirection:"column",width:"100vw",height:"100vh"}})),vr=function(e){var t=e.file,n=(e.datasetName,e.dataset),o=(e.content,e.inSession),i=e.url,c=e.fileName,l=void 0===c?"unnamed":c,s=e.onChangeDataset,u=void 0===s?function(){return null}:s,m=e.onChangeFile,d=(e.onFileDrop,e.initialMode),p=void 0===d?"setup":d,b=e.authConfig,h=e.user,v=(e.recentItems,e.selectedBrush),O=Object(a.useState)(l),E=Object(g.a)(O,2),j=E[0],w=E[1],y=gr(),S=or().addToast,C=Object(a.useState)(p),x=Object(g.a)(C,2),k=x[0],I=x[1],T=Object(a.useState)(),N=Object(g.a)(T,2),D=N[0],L=N[1],P=Object(a.useState)({}),_=Object(g.a)(P,2),R=_[0],A=_[1],B=Object(a.useState)(),M=Object(g.a)(B,2),z=M[0],U=M[1],J=Me(),F=function(){var e=Object(a.useReducer)((function(e,t){var n=e.samplesInWindow.slice(-10).concat([t]);return{timeToCompleteSample:n.reduce((function(e,t){return e+t}),0)/n.length,samplesInWindow:n}}),{timeToCompleteSample:0,samplesInWindow:[]}),t=Object(g.a)(e,2);return[t[0].timeToCompleteSample,t[1]]}(),W=Object(g.a)(F,2),H=W[0],V=W[1];Object(a.useEffect)((function(){"json"===k&&U(JSON.stringify(n,null,"  ")),"label"!==k&&L(null),J.capture("open_editor_tab",{tab:k})}),[k,J,U,n]),Object(a.useEffect)((function(){if(z&&"json"===k)try{u(JSON.parse(z))}catch(e){}}),[z,k,u]);var G=Object(mt.a)((function(e){return I(e.toLowerCase())})),q=Object(a.useMemo)((function(){return{switch_to_label:function(){return I("label")},switch_to_setup:function(){return I("setup")},switch_to_samples:function(){return I("samples")}}}),[I]),K=Fa().keyMap;return r.a.createElement(hr.HotKeys,{allowChanges:!0,handlers:q,keyMap:K},r.a.createElement("div",{className:ht()(y.container,"universaldatatool")},r.a.createElement(pe,{title:o?r.a.createElement(Qe.a,{label:"Share Link",title:"share-link",value:i,variant:"outlined",size:"small"}):r.a.createElement(nt,{label:"File Name",onChange:function(e){m(Object(en.setIn)(t,["fileName"],e)),w(e)},value:j||""}),onChangeTab:G,currentTab:k,tabs:["Setup","Samples","Label"]}),r.a.createElement("div",{style:{height:"100%",overflowY:"scroll"}},"json"===k&&r.a.createElement($e.a,{theme:"github",mode:"javascript",width:"100%",value:z||"",editorProps:{$blockScrolling:1/0},onChange:function(e){return U(e)}}),"setup"===k&&r.a.createElement(Xa,{onClickEditJSON:function(){return I("json")},dataset:n,onClearLabelData:function(){u(Object(en.setIn)(n,["samples"],n.samples.map((function(e){return Object(en.without)(e,"annotation")}))))},onChange:function(e){e.type!==n.interface.type&&"empty"!==n.interface.type&&n.samples.map((function(e){return e.annotation})).some(Boolean)?S("Changing label types can cause label data issues. You must clear all label data first.","error"):u(Object(f.a)(Object(f.a)({},n),{},{interface:e}))}}),"samples"===k&&r.a.createElement(Vn,{file:t,dataset:n,openSampleLabelEditor:function(e){L(Object(f.a)(Object(f.a)({},n),{},{samples:[n.samples[e]],sampleIndex:e,annotationStartTime:Date.now()})),J.capture("open_sample",{interface_type:n.interface.type}),I("label")},openSampleInputEditor:function(e){A({open:!0,sampleIndex:e})},deleteSample:function(e){var t=Object(Ye.a)(n.samples);t.splice(e,1),u(Object(f.a)(Object(f.a)({},n),{},{samples:t}))},onChangeFile:function(e){m(e),w(e.fileName)},onChangeDataset:u,authConfig:b,user:h}),"label"===k&&r.a.createElement(br,{selectedBrush:v,dataset:n,sampleTimeToComplete:H,onChangeSampleTimeToComplete:V,onChangeDataset:u,singleSampleDataset:D,onChangeSingleSampleDataset:L,onClickSetup:function(){return I("setup")}})),r.a.createElement(er,Object.assign({},R,{sampleInput:void 0!==R.sampleIndex?n.samples[R.sampleIndex]:null,onClose:function(){A({open:!1})},onChange:function(e){u(Object(en.setIn)(n,["samples",R.sampleIndex],e))}}))))},Or=Object(S.a)({root:{position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,alignItems:"center",pointerEvents:"none"},errorBox:{display:"flex",backgroundColor:ke.a[700],color:"#fff",padding:4,marginBottom:4}}),Er=function(e){var t=e.errors,n=Or();return r.a.createElement("div",{className:n.root},t.map((function(e){return r.a.createElement(tr.a,{key:e.id,in:e.life<5e3},r.a.createElement(nr.a,{in:e.life>500},r.a.createElement("div",{className:n.errorBox},e.message)))})))},jr=n(383),wr=n(207),yr=n.n(wr),Sr=function(e){var t,n=[],a=Object(at.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value,o=r.userName,i=r.op,c=r.path;if(c.startsWith("/interface"))n.push({type:"warning",message:"".concat(o," changed the project settings")});else if(c.startsWith("/taskOutput")){var l=c.match(/\/samples\/([^/]+)/);n.push({type:"info",message:"".concat(o," changed sample ").concat(l[1])})}else n.push({message:"".concat(o," did a ").concat(i," at ").concat(c),type:"info"})}}catch(no){a.e(no)}finally{a.f()}return n},Cr=tn.a.setIn,xr=tn.a.getIn,kr=tn.a.updateIn,Ir=tn.a.without;function Tr(e,t){return e.concat([t])}function Nr(e,t){if(0===t.length)return Ir(e,t[0]);var n=t.slice(0,-1),a=t[t.length-1],r=xr(e,n);if(Array.isArray(r)){var o=parseInt(a);return Cr(e,n,[].concat(Object(Ye.a)(r.slice(0,o)),Object(Ye.a)(r.slice(o+1))))}return Cr(e,n,Ir(r,a))}var Dr=function(e,t){var n,a=Object(at.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value,o=r.op,i=r.path;if(0===(i=i.split("/").filter(Boolean)).length){if("replace"===o){e=r.value;continue}throw new Error("Operation on root object not supported")}switch(o){case"replace":e=Cr(e,i,r.value);continue;case"copy":e=Cr(e,i,xr(e,r.from.split("/")));continue;case"add":if(isNaN(parseInt(i.slice(-1)[0])))e=Array.isArray(xr(e,i))?kr(e,i,Tr,r.value):Cr(e,i,r.value);else e=Cr(e,i,r.value);continue;case"move":var c=r.from.split("/");e=Nr(e=Cr(e,i,xr(e,c)),c);continue;case"remove":e=Nr(e,i);continue;default:return e}}}catch(no){a.e(no)}finally{a.f()}return e},Lr=n(716),Pr=function(e){return function(e){var t,n=0;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n}(Lr(e))},_r=new(function(){function e(t){var n=t.serverUrl,a=t.userName;Object(Ea.a)(this,e),this.serverUrl="http://localhost:6003",this.getJSON=function(e,t,n){},this.postJSON=function(e,t,n){},this.patchJSON=function(e,t,n){},this.userName="anonymous",this.sessionId=null,this.state=null,this.version=null,this.serverUrl=n,this.getJSON=yr()("json","GET",n),this.postJSON=yr()("json","POST",n),this.patchJSON=yr()("json","PATCH",n),this.userName=a||"anonymous_".concat(Math.random().toString(36).slice(2,6))}return Object(ja.a)(e,[{key:"createSession",value:function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.postJSON("/api/session",{udt:t});case 2:n=e.sent,this.state=t,this.sessionId=n.short_id,this.version=n.version;case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLatestState",value:function(){var e=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getJSON("/api/session/".concat(encodeURIComponent(this.sessionId)));case 3:return t=e.sent,e.abrupt("return",{state:t.udt_json,version:t.version});case 7:throw e.prev=7,e.t0=e.catch(0),new Error('error getting session "'.concat(this.sessionId,'": ').concat(e.t0.toString()));case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"updateToLatestState",value:function(){var e=Object(h.a)(b.a.mark((function e(){var t,n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLatestState();case 2:t=e.sent,n=t.state,a=t.version,this.state=n,this.version=a;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"joinSession",value:function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.sessionId=t,e.next=3,this.updateToLatestState();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"applyLatestPatches",value:function(){var e=Object(h.a)(b.a.mark((function e(){var t,n,a,r,o,i,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getJSON("/api/session/".concat(encodeURIComponent(this.sessionId),"/diffs?since=").concat(this.version));case 2:if(t=e.sent,n=t.patch,a=t.hashOfLatestState,r=t.latestVersion,o=t.changeLog,0!==n.length&&r!==this.version){e.next=9;break}return e.abrupt("return",null);case 9:if(i=Sr(o),c=Dr(this.state,n),Pr(c)===a){e.next=16;break}return console.error("new state with patches applied didn't match latest state"),e.next=15,this.updateToLatestState();case 15:return e.abrupt("return",{patch:n,changeLog:i});case 16:return this.state=c,this.version=r,e.abrupt("return",{patch:n,changeLog:i});case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendPatchIfChanged",value:function(){var e=Object(h.a)(b.a.mark((function e(t){var n,a,r,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(n=jr.createPatch(this.state,t)).length){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this.patchJSON("/api/session/".concat(encodeURIComponent(this.sessionId)),{patch:n,userName:this.userName});case 5:if(a=e.sent,r=a.hashOfLatestState,o=a.latestVersion,Pr(t)===r){e.next=13;break}return console.error("after patch, hashes were not equal! getting latest version from server..."),e.next=12,this.updateToLatestState();case 12:return e.abrupt("return",this);case 13:return this.state=t,this.version=o,e.abrupt("return",this);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}())({serverUrl:window.localStorage.CUSTOM_COLLABORATION_SERVER||"https://udt-collaboration-server.now.sh"}),Rr=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_r.createSession(t.content);case 2:return e.abrupt("return",{fileName:t.fileName,id:t.id,sessionId:_r.sessionId,url:"".concat(window.location.origin,"?s=").concat(_r.sessionId),content:t.content,mode:"server"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ar=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_r.joinSession(t);case 2:return e.abrupt("return",{state:_r.state,version:_r.version});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Br=n(245),Mr=function(e){var t,n=function(e){a.add(e)},a=new Set,r=Object(at.a)(e.samples);try{for(r.s();!(t=r.n()).done;){var o=t.value;Object.keys(Object(Br.flatten)(o)).forEach((function(e){return n(e)}))}}catch(no){r.e(no)}finally{r.f()}(a=Array.from(a).sort((function(e,t){return e.split(".").length-t.split(".").length}))).some((function(e){return e.includes("output.keyframes")}))&&(a=a.filter((function(e){return e.includes("output.keyframes")}))).push("output.keyframes");var i={rows:["interface"].concat(Object(Ye.a)(pt()(e.samples.length).map((function(e){return"samples.".concat(e)})))),columns:["."].concat(Object(Ye.a)(a))};return sn.a.toCSV(e,i)},zr={saveFile:function(){return null}},Ur=function(e,t){if(!(!!window.require&&Boolean(window.require("electron"))))return zr;var n=or().addToast,r=Object(mt.a)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.saveAs;function a(){return r.apply(this,arguments)}function r(){return(r=Object(h.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.filePath.require("fs").writeFile(a,a.endsWith(".csv")?Mr(e.content):JSON.stringify(e.content,null,"  ")),n("File Saved!");case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e&&a()}));return Object(a.useEffect)((function(){e&&e.filePath&&e.fileName!==e.filePath.split("/").slice(-1)[0]&&t(Object(en.setIn)(e,["filePath"],e.filePath.split("/").slice(0,-1).concat([e.fileName+(e.fileName.endsWith(".json")?"":".dataset.json")]).join("/")))}),[e,t]),{saveFile:r}},Jr=function(){var e=Object(a.useState)(),t=Object(g.a)(e,2),n=t[0],r=t[1],o=(or().addToast,Ur(n,r).saveFile),i=function(e,t){var n=Object(dt.a)("recentItems",[]),r=Object(g.a)(n,2),o=r[0],i=r[1];return o||(o=[]),Object(a.useEffect)((function(){e&&"unnamed"!==e.fileName&&(o.map((function(e){return e.id})).includes(e.id)?i(o.map((function(t){return t.id===e.id?e:t}))):i([e].concat(o).slice(0,3)))}),[e,i]),{recentItems:o,changeRecentItems:i}}(n),c=i.recentItems,l=i.changeRecentItems;!function(e,t){var n=window.localStorage.userName;Object(a.useEffect)((function(){if(n&&!n.includes("anonymous"))try{_r.userName=JSON.parse(window.localStorage.userName)}catch(e){}}),[n]),Object(a.useEffect)((function(){if(e&&"server"===e.mode&&e.sessionId===_r.sessionId){var n=function(){var r=Object(h.a)(b.a.mark((function r(){return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,_r.applyLatestPatches();case 2:if(r.sent&&t(Object(en.setIn)(e,["content"],_r.state)),a){r.next=6;break}return r.abrupt("return");case 6:a=setTimeout(n,500);case 7:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),a=setTimeout(n,500);return function(){clearTimeout(a),a=null}}}),[e,t]),Object(a.useEffect)((function(){e&&"server"===e.mode&&_r.sendPatchIfChanged(e.content)}),[e])}(n,r);var s=Object(mt.a)((function(e){var t=e.name,n=e.path;function a(e){try{var a;a=t.endsWith("csv")?En(e):JSON.parse(e),r({fileName:t,filePath:n,mode:n?"filesystem":"local-storage",content:a,id:n})}catch(o){console.log(o.toString())}}if(e.content)a(e.content);else{var o=new FileReader;o.onload=function(e){a(e.target.result)},o.readAsText(e)}})),u=Object(mt.a)(function(){var e=Object(h.a)(b.a.mark((function e(t){var n,a,o,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=decodeURIComponent(t.match(/[?&]s=([^&]+)/)[1]),a=t.includes("mode=labelonly"),n){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Ar(n);case 6:if(o=e.sent,i=o.state){e.next=10;break}return e.abrupt("return");case 10:window.history.replaceState({},window.document.title,"/?s=".concat(encodeURIComponent(n)).concat(a?"&mode=labelonly":"")),r({url:t,sessionId:n,mode:"server",id:n,content:i});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());Object(a.useEffect)((function(){n&&"server"!==n.mode&&window.history.replaceState({},window.document.title,"/")}),[n]),Object(a.useEffect)((function(){window.location.search.match(/[?&]s=([a-zA-Z0-9]+)/)&&u(window.location.href)}),[u]);var m=Object(mt.a)(Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Rr(n);case 2:t=e.sent,r(t),window.history.replaceState({},window.document.title,"/?s=".concat(encodeURIComponent(t.sessionId)));case 5:case"end":return e.stop()}}),e)}))));return Object(a.useMemo)((function(){return{file:n,setFile:r,openFile:s,openUrl:u,makeSession:m,saveFile:o,recentItems:c,changeRecentItems:l}}),[n,r,s,o,m,c,l,u])},Fr=n(258),Wr=n.n(Fr),Hr=n(384),Vr=Object(A.a)("div")({width:"100vw",minHeight:"100vh",backgroundColor:B.a[900],padding:32,"& .title":{color:B.a[200],fontSize:24,fontWeight:"bold"},"& .subtitle":{color:B.a[300],fontSize:18,marginTop:8},"& .info":{width:"100%",boxSizing:"border-box",padding:32,"& textarea":{width:"calc(100% - 64px)",boxSizing:"border-box",minHeight:300,fontSize:12}}}),Gr=Object(A.a)("div")({padding:8}),qr=Object(A.a)(z.a)({color:"#fff",borderColor:"rgba(255,255,255,0.5)",margin:8}),Kr=function(e){Object(wa.a)(n,e);var t=Object(ya.a)(n);function n(e){var a;return Object(Ea.a)(this,n),(a=t.call(this,e)).state={hasError:!1},a}return Object(ja.a)(n,[{key:"componentDidCatch",value:function(e,t){var n=this;xa.withScope((function(a){a.setExtras(t);var r=xa.captureException(e);n.setState({eventId:r})}))}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(Vr,null,r.a.createElement("div",{className:"title"},"An error has occurred"),r.a.createElement("div",{className:"subtitle"},"All the details are below:"),r.a.createElement("div",{className:"info"},r.a.createElement("textarea",null,this.state.errorDetails)),r.a.createElement(Gr,null,r.a.createElement(qr,{variant:"outlined",onClick:function(){return window.location.reload()}},"Reload (unsaved progress will be lost)"))):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,errorDetails:JSON.stringify(Object(Hr.detect)())+"\n\n"+e.stack}}}]),n}(r.a.Component);function Yr(e){var t="It looks like you have been editing something. If you leave before saving, your changes will be lost.";return(e||window.event).returnValue=t,t}n(341);var Zr=Object(a.createContext)({}),$r=function(){var e=Jr(),t=e.file,n=e.setFile,o=e.openFile,i=e.openUrl,c=e.makeSession,l=e.recentItems,s=e.changeRecentItems;!function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object(a.useEffect)((function(){if(e&&!window.location.origin.includes("localhost"))return window.addEventListener("beforeunload",Yr),function(){window.removeEventListener("beforeunload",Yr)}}),[e])}(Boolean(t));var u=function(){var e=Object(a.useState)([]),t=Object(g.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){if(0===n.length)return function(){};var e=setInterval((function(){r(n.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{life:e.life-100})})).filter((function(e){return e.life>0})))}),100);return function(){return clearInterval(e)}}),[n]),[n,function(e){r(n.concat([{id:Math.random().toString().split(".")[1],message:e,life:5e3}]))}]}(),m=Object(g.a)(u,1)[0],d=Object(a.useState)("complete"),p=Object(g.a)(d,2),v=p[0],O=p[1],E=Object(mt.a)((function(e){n({fileName:"unnamed",content:e.dataset,id:Math.random().toString().split(".")[1],mode:"local-storage"})})),j=Object(mt.a)((function(e){return n(e)})),w=Object(mt.a)((function(){return n(null)})),y=Object(mt.a)((function(e){if(t){var n=(t.sessionId||t.fileName)+".udt."+e;"json"===e?Wr()(JSON.stringify(t.content),n):"csv"===e&&Wr()(Mr(t.content),n)}})),S=t&&"server"===t.mode,C=Object(a.useState)(!1),x=Object(g.a)(C,2),k=x[0],I=x[1],T=Object(a.useCallback)(function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),N=Object(mt.a)((function(){return n(Object(f.a)(Object(f.a)({},t),{},{mode:"local-storage",fileName:t.fileName||"copy_of_".concat(t.id)}))})),D=Object(mt.a)((function(e){n(Object(en.setIn)(t,["content"],e))}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(Zr.Provider,{value:{file:t,setFile:n}},r.a.createElement(de.Provider,{value:{title:t?"local-storage"===t.mode?t.fileName:t.url:"unnamed",recentItems:l,changeRecentItems:s,onClickTemplate:E,onClickHome:w,onOpenFile:o,onOpenRecentItem:j,inSession:S,sessionBoxOpen:k,changeSessionBoxOpen:I,onJoinSession:T,onLeaveSession:N,onCreateSession:c,fileOpen:Boolean(t),onDownload:y,onChangeSelectedBrush:O,selectedBrush:v,isWelcomePage:!t}},t?r.a.createElement(Kr,null,r.a.createElement(vr,Object.assign({file:t,key:t.id},t,{selectedBrush:v,inSession:S,dataset:t.content,onChangeDataset:D,onChangeFile:n,authConfig:!0,recentItems:l}))):r.a.createElement(Ke,{onFileDrop:o,onOpenTemplate:E,recentItems:l,onOpenRecentItem:j,onClickOpenSession:function(){return I(!0)}}))),r.a.createElement(Er,{errors:m}))},Qr=(n(720),n(331)),Xr=Object(S.a)((function(e){return{wrapper:{width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},root:{display:"flex","& > * + *":{marginLeft:e.spacing(2)}}}}));function eo(){var e=Xr();return r.a.createElement("div",{className:e.wrapper},r.a.createElement("div",{className:e.root},r.a.createElement(Qr.a,null)))}var to=function(){return r.a.createElement(a.Suspense,{fallback:eo},r.a.createElement(d,null,r.a.createElement(qa,null,r.a.createElement(ir,null,r.a.createElement(Wa,null,r.a.createElement($r,null))))))};i.a.render(r.a.createElement(to,null),document.getElementById("root"))}},[[411,1,2]]]);
//# sourceMappingURL=main.f65bfaa9.chunk.js.map